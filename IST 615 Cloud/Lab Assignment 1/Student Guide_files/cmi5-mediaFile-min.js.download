/*! Copyright 2003-2018 Rustici Software, LLC All Rights Reserved. Rustici-Engine 20.1.1 2022-01-25T00:47:24+0000 4440405 Media File Content */

function isParentCrossOrigin(e){var t;try{t=e.parent.location.origin!==e.location.origin}catch(e){t=!0}return t}function getPlayerWindow(){var e=0,t=window;if(void 0!==t.opener&&null!==t.opener){if(void 0!==t.opener.Control&&null!==t.opener.Control)return t.opener;if(void 0!==t.opener.parent&&null!==t.opener.parent&&void 0!==t.opener.parent.Control&&null!==t.opener.parent.Control)return t.opener.parent}for(;(void 0===t.Control||null===t.Control)&&null!==t.parent&&t.parent!==t&&e<=500&&!isParentCrossOrigin(t);)e+=1,t=t.parent;return void 0===t.Control||null===t.Control?null:t}function getReferenceToControlObject(e){var t=getPlayerWindow();if(null!==t)return t.Control;if(e)return null;throw alert("Could not locate the control object."),new Error("Could not locate the control object.")}function getReferenceToIntegrationImplementationObject(e){var t=getPlayerWindow();if(null!==t&&void 0!==t.IntegrationImplementation&&null!==t.IntegrationImplementation)return t.IntegrationImplementation;if(e)return null;throw alert("Could not locate the integration implementation object."),new Error("Could not locate the integration implementation object.")}var auRunner={};!function(){"use strict";function l(e,t){return""!==e&&-1===t.indexOf(e)}function s(e){return e+"?version="+C.get("version")+"-"}function o(e){var t={},n={};return auRunner.appendStatementProperties(t,n,e),{context:{extensions:t},target:{definition:{type:auRunner.getActivityType()}},result:{extensions:n}}}function i(e){var t={isComplete:f};auRunner.appendSaveStateContents(t),c.getLRS().saveState("mediaContentStatus",JSON.stringify(t),{agent:v.agent,activity:v.activity,registration:v.registration,callback:e})}function a(e){var t,n=null,r=!1!==e;if(-1===(g=auRunner.getProgress()))return auRunner.displayError("The media file's 'duration' was set to 0. It is likely that the file's metadata is missing or corrupted."),void clearInterval(p);try{c.setProgress(Math.round(100*g))}catch(e){console.warn(e)}1===parseFloat(g)&&clearInterval(p),w<=g&&!f&&(t=o(!(f=!0)),R?(n=function(e){null!==e&&auRunner.displayError("Error saving current state: "+e)},E.push(c.completedStatement(t))):c.completed(function(e){null!==e&&(f=!1,auRunner.displayError("Error sending 'completed' statement: "+e))},t),r&&i(n))}function n(e){var t=null,n={};if(R=!0,!h)return m=!0,auRunner.closeAU(),0;void 0!==e&&(n.callback=e,t=function(e){null!==e&&auRunner.displayError("Error saving current state: "+e)}),y||(m=!0,auRunner.preTerminate(),a(!1),i(t),E.push(c.terminatedStatement(o(!0))),c.getLRS().saveStatements(E,n),y=!0)}function u(){!e&&"function"==typeof fetch&&"keepalive"in new Request("")&&(e=!0,c.getLRS()._makeRequest=function(e,t,n){var r,o,i=[],a=e;for(o in n.params)n.params.hasOwnProperty(o)&&i.push(o+"="+encodeURIComponent(n.params[o]));a=c.getLRS()._IEModeConversion(a,t,i,n),r={mode:"cors",cache:"no-cache",credentials:"include",keepalive:!0,method:n.method,headers:{"Content-Type":t["Content-Type"]},body:n.data};try{return fetch(a,r).then(function(e){c.log("Overridden request Fetch with KeepAlive finished with status "+e.status+":"+e.statusText)}).catch(function(e){c.log("Overridden request Fetch with KeepAlive returned error: "+e.message)}),{err:null}}catch(e){return c.log("Overridden request Fetch with KeepAlive threw error: "+e.message),{err:e.message,xhr:null}}})}function d(){var e=document.getElementById("rscpAu-ToolbarInfo"),t=document.getElementById("rscpAu-CloseBtn");null===t&&((t=document.createElement("button")).id="rscpAu-CloseBtn",t.innerHTML=auRunner.translate("Close"),t.onclick=function(){confirm(auRunner.translate("Would you like to exit the course now?"))&&(n(),auRunner.closeAU())},e.appendChild(t))}var c,p,g,r,m=!1,y=!1,f=!1,h=!1,v={},C=getPlayerWindow().rscpCfg,w=C.get("mediaContentCompletionThreshold")/100,R=!1,E=[],e=!1;auRunner.prepareAndSendStatement=function(t,e,n,r){var o,i,a,u,l=!1,s=r||{};if(y)auRunner.displayError("A 'Terminated' statement has already been sent. Further statements can not be sent.");else{for(a in o=c.prepareStatement(t),s.verbDisplay&&(o.verb.display=s.verbDisplay),e)e.hasOwnProperty(a)&&(o.context.extensions[a]=e[a]);for(a in n)if(n.hasOwnProperty(a)){l=!0;break}if(l){for(a in(i=new TinCan.Result).extensions={},n)n.hasOwnProperty(a)&&(i.extensions[a]=n[a]);o.result=i}s.category&&((u=o.context.contextActivities.category||[]).push(s.category),o.context.contextActivities.category=u),s.target&&(o.target=s.target),s.duration&&(o.result.duration=s.duration)}R?E.push(o):c.sendStatement(o,function(e){null!==e&&auRunner.displayError("Error sending the xAPI statement - "+t+" : "+e)})},auRunner.displayError=function(e){var t,n=document.getElementById("rscpAu-ErrorContainer"),r=document.getElementById("rscpAu-MediaContainer"),o=document.getElementById("viewerContainer"),i=document.getElementById("viewer"),a=document.createTextNode(e);d(),null===n&&((n=document.createElement("div")).id="rscpAu-ErrorContainer",(t=document.createElement("p")).innerHTML=auRunner.translate("We apologize, an error has occurred."),n.appendChild(t)),n.appendChild(a),document.body.insertBefore(n,r),null!==o&&(o.style.visibility="hidden",i.style.visibility="hidden"),null!==r&&(r.style.visibility="hidden")},auRunner.closeAU=function(){m?window.location.replace(r):n()},auRunner.translate=function(e){return getPlayerWindow().IntegrationImplementation.GetString(e)};try{c=new Cmi5(document.location.href)}catch(e){return auRunner.displayError("Error creating the cmi5 object: "+e)}c.start(function(e){var t;if(null===e){v={agent:c.getActor(),activity:c.getActivity(),registration:c.getRegistration(),sessionId:c.getSessionId()};try{t=JSON.parse(c.getLaunchParameters())}catch(e){return void auRunner.displayError("Error attempting to parse launch parameters: "+e)}document.title=t.contentTitle,document.getElementById("rscpAu-ToolbarTitle").textContent=t.contentTitle,void 0!==C.get("topParams").cc&&""!==C.get("topParams").cc&&document.documentElement.setAttribute("lang",C.get("topParams").cc),null!==C.get("langDirection")&&document.documentElement.setAttribute("dir",C.get("langDirection"));try{r=c.getReturnURL()}catch(e){return void auRunner.displayError("Unable to get returnUrl from cmi5 object: "+e)}loadSupportFiles(function(e,t){var n,r=[],o="application/pdf"===e,i="audio/mpeg"===e,a="video/mp4"===e,u="youtube"===e;for(o?r.push("../style/pdf_viewer.css","../js/mediaFileSupport/pdfContent-min.js"):i||a?i||"videojs"!==C.get("audioVideoPlayer")?r.push("../js/mediaFileSupport/audioVideoContentNative-min.js"):(r.push("../js/mediaFileSupport/audioVideoContentVideoJS-min.js"),r.push("../style/video-js.min.css"),r.push("../style/material-icons.css"),r.push("../style/videojsPlayerPlaybackControl.css")):u?r.push("../js/mediaFileSupport/youTubeContent-min.js"):void 0!==t&&r.push("../js/mediaFileSupport/webContent-min.js"),""!==C.get("mediaContentStylesheet")&&r.push(C.get("mediaContentStylesheet")),o&&l(C.get("pdfContentStylesheet"),r)&&r.push(C.get("pdfContentStylesheet")),(i||a)&&l(C.get("audioVideoContentStylesheet"),r)&&r.push(C.get("audioVideoContentStylesheet")),n=0;n<r.length;n+=1)r[n]=s(r[n]);return r}(t.MIMEType,t.launchUrl),function(e){null===e?(auRunner.initializeUI(t,{forceNewWindow:C.get("webContentForceNewWindow"),pageViewedThreshold:C.get("pdfPageViewThreshold"),pdfDownloadButton:C.get("pdfDownloadButton"),pdfContentScaling:C.get("pdfContentScaling"),activityId:c.getActivity().id,audioVideoPlayer:C.get("audioVideoPlayer"),audioVideoPlayerCfg:{qualityLevelSources:t.qualityLevelSources,seekForward:C.get("seekForward"),seekBackward:C.get("seekBackward"),playbackRates:C.get("playbackRates")}},function(e){var r;null===e?(d(),r=function(e){var t;null===e?c.initialize(function(e){var t;null===e?(t=!(h=!0),window.addEventListener("beforeunload",function(){u(),t||(t=!0,n())}),window.addEventListener("unload",function(){u(),y||n(function(e){null===e?y=!0:auRunner.displayError("Error sending 'terminate' statement: "+e)})}),p=setInterval(a,1e3),auRunner.bindMedia(),auRunner.postInitialize()):auRunner.displayError("Encountered an error initializing AU session: "+e)},(t={userAgent:navigator.userAgent,completionThreshold:w,sessionId:c.getSessionId()},auRunner.generateCustomInitializeProperties({},t))):auRunner.displayError("Error setting current status from a previously stored state: "+e)},c.getLRS().retrieveState("mediaContentStatus",{agent:v.agent,activity:v.activity,registration:v.registration,callback:function(e,t){var n=null;if(null!==e)return r(e);if(!t)return r(null);try{n=JSON.parse(t.contents)}catch(e){return r(e)}f=n.isComplete,auRunner.loadStateData(n,r)}})):auRunner.displayError("Error initializing the UI: "+e)}),loadSupportFiles(function(e){var t,n=[];for("youtube"===e&&n.push("https://www.youtube.com/iframe_api"),t=0;t<n.length;t+=1)n[t]=s(n[t]);return n}(t.MIMEType),function(e){null!==e&&auRunner.displayError("Error loading content support files: "+e)})):auRunner.displayError("Error loading content support files: "+e)})}else auRunner.displayError("Error calling the cmi5.start() method: "+e)},null,{breakBeforeInitializeStatement:!0})}();
//# sourceMappingURL=cmi5-mediaFile-min.js.map